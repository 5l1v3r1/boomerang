
add_custom_command(OUTPUT copy-regression-script
    COMMAND ${CMAKE_COMMAND} ARGS -E copy_if_different ${CMAKE_CURRENT_SOURCE_DIR}/regression_tester.py ${BOOMERANG_OUTPUT_DIR}/
    DEPENDS "${CMAKE_CURRENT_SOURCE_DIR}/regression_tester.py"
)

# run regression suite by 'make check'
add_custom_target(check
    "${CMAKE_CURRENT_SOURCE_DIR}/full_regression.sh" "$<TARGET_FILE:boomerang-cli>"
    WORKING_DIRECTORY "${BOOMERANG_OUTPUT_DIR}/"
    DEPENDS copy-regression-script
)
